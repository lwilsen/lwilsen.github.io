<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Bayesian Modelling | Luke W. Wilsen </title> <meta name="author" content="Luke W. Wilsen"> <meta name="description" content="My final project from my Bayesian Modelling class at UMass Amherst"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/data_science.jpg?5055520f00cf2967c6230d7eb2210de5"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://lwilsen.github.io/projects/4_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Luke</span> W. Wilsen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item dropdown active"> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Project Dropdown <span class="sr-only">(current)</span> </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/projects/1_project/">ADSB Airports</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/2_project/">IEX Final Project</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/3_project/">IEX Training</a> <div class="dropdown-divider"></div> <a class="dropdown-item active" href="/projects/4_project/">Bayesian Modelling</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/5_project/">CMS Independent Study</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Bayesian Modelling</h1> <p class="post-description">My final project from my Bayesian Modelling class at UMass Amherst</p> </header> <article> <h2 id="final-project-for-biostatistics-730--umass-amherst-fall-2024">Final Project for Biostatistics 730 @ UMass Amherst Fall 2024</h2> <p><a href="https://github.com/lwilsen/BS_730_proj" rel="external nofollow noopener" target="_blank">Link to Repo</a></p> <h2 id="summary">Summary</h2> <p>Hospitals in the U.S. were overrun during the COVID pandemic due to limited resources and increased burden of illness. It is important for public health and healthcare organizations to prioritize care (using hospital beds for severe cases). An accurate prediction model may help identify those at high risk and need for hospitalization. This may improve resource efficiency.</p> <p>The <em>primary outcome</em> of interest is hospitalization (binary).</p> <p>The <em>research question</em> is: can we predict the risk of hospitalization for COVID based on demographic and clinical factors, including:</p> <ul> <li>Age group</li> <li>Sex</li> <li>Race</li> <li>Ethnicity</li> <li>Exposure</li> <li>Symptom Status</li> <li>Underlying Conditions</li> </ul> <p>The <em>Bayesian models</em> we plan to produce include:</p> <ul> <li>Bayesian Logistic Regression</li> <li>Bayesian Hierarchical Model (By State)</li> </ul> <p>Given the significant amount of missing data in reports, we will explore various methods including multiple imputation (e.g., mice package) and/or <code class="language-plaintext highlighter-rouge">brm_multiple</code> function for multiple imputed data sets (see <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_missings.html#compatibility-with-other-multiple-imputation-packages" rel="external nofollow noopener" target="_blank">vignette</a>).</p> <p>Example resources:</p> <p>Bayesian Hierarchical Spatial Model to Correct for Misreporting in Count Data: Application to State-Level COVID-19 Data in the United States [@Chen2022]</p> <p>Bayesian Hierarchical models incorporating study-level covariates for multivariate meta-analysis of diagnostic tests without a gold standard with application to COVID-19 [@Wang2023]</p> <p>A Bayesian hierarchical model for estimating the statistical parameters in a three-parameter log-normal distribution for monthly average streamflows [@li2020]</p> <h2 id="data">Data</h2> <p>We will use data from the CDC available <a href="https://data.cdc.gov/Case-Surveillance/COVID-19-Case-Surveillance-Public-Use-Data-with-Ge/n8mc-b4w4/about_data" rel="external nofollow noopener" target="_blank">here</a>. This includes case surveillance (public use) with for all COVID-19 cases shared with the CDC, including demographics, geography (e.g., state), exposure history, disease severity indicators, and outcomes (e.g., hospitalization). It also includes underlying medical conditions. Reporting of data was discontinued July 1, 2024.</p> <h2 id="action-plan">Action plan</h2> <p>We will consider a “Bayesian Workflow” [@gelman2020] with an iterative process, and will build a model, evaluate (diagnostics), and try to improve and expand the model in different ways.</p> <ol> <li> <p>We will clean, recode, and explore the data. This includes descriptive analyses (frequencies, summary statistics), histograms, scatterplots, and related covariates to outcomes.</p> </li> <li> <p>We will explore missingness of data. This includes amount of missingness, and pattern of missingness (is it at random?).</p> </li> <li> <p>We will establish an initial model (will start simple and expand). This will include those covariates deemed worthy based on missingness as well as relationship with outcome. A potential candidate model may include:</p> </li> </ol> <p>Let $Y_i$ denote the binary outcome (hospitalization), where:</p> <p>\(Y_i = \begin{cases} 1, &amp; \text{if the individual is hospitalized} \\ 0, &amp; \text{otherwise} \end{cases}\) and:</p> \[Y_i | \pi_i \sim \text{Bern}(\pi_i)\] <p>Let $\mathbf{X}<em>i = (X</em>{1,i}, X_{2,i}, X_{3,i}, X_{4,i})$ include all of the covariates for individual $i$, where:</p> <ul> <li>$X_{1,i}$: Underlying condition</li> <li>$X_{2,i}$: Age group</li> <li>$X_{3,i}$: Exposure</li> <li>$X_{4,i}$: Symptoms</li> </ul> <p>Then the posterior distribution would resemble:</p> <p>Our logistic Bayesian model would then be:</p> <table> <tbody> <tr> <td>$ \text{logit}(\pi_i) = \log \left( \frac{P(Y_i = 1</td> <td>\mathbf{X}_i)}{1 - P(Y_i = 1</td> <td>\mathbf{X}<em>i)} \right) = \beta_0 + \beta_1 X</em>{1,i} + \beta_2 X_{2,i} + \beta_3 X_{3,i} + \beta_4 X_{4,i} $</td> </tr> </tbody> </table> <p>We will use normal priors for all covariates, and then re-visit the model to experiment with other generic priors (i.e. a student t(3, 0 ,1) preferred by Aki Vehtari (https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations))</p> <p>The prior distribution would assume normal for all covariates:</p> <p>$ \beta_j \sim \mathcal{N}(0, \sigma^2) \quad \text{for} \quad j = 0, 1, 2, 3, 4 $</p> <p>Note this initial model does not include state for hierarchical expression.</p> <ol> <li> <p>We will pursue prior predictive checks.</p> </li> <li> <p>We will validate results and address any issues that arise. we will try to fit fast and fail fast. We will explore MCMC diagnostics. If there are computational issues, will consider subsetting data or using specific date range from CDC.</p> </li> <li> <p>We will modify the model and explore additional situations. For example, we will consider the hierarchical model (state as group) once we have confidence based on other covariates and models.</p> </li> <li> <p>We will validate the model using LOO internally. In addition, we will assess the model’s performance on new (unseen) data, but using a different date range of data.</p> </li> <li> <p>If time allows, we will consider interaction terms in the model and compare its performance. We will also investigate performance of prediction across different states, particularly those with less cases reported. Other investigations have been considered, depending on time, just for the additional experience.</p> </li> <li> <p>Our group will work together in parallel with shared data and code in github. This will allow for independent trial/error exploration and comparison of approaches. We will check in with our results each week on Tuesdays and Thursdays. The final product will incorporate our consensus on best model and approach.</p> </li> </ol> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Luke W. Wilsen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>